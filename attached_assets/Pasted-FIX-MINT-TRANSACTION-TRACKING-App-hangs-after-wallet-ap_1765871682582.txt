FIX MINT TRANSACTION TRACKING - App hangs after wallet approval

PROBLEM:
User approves mint in wallet, but app gets stuck. Transaction may be:
1. Pending on chain (not confirming)
2. Confirmed but app not detecting it
3. Failed silently

ADD BETTER TRANSACTION TRACKING to useMint.ts:

import { useState, useCallback, useEffect } from 'react';
import { useAccount, useWriteContract, useWaitForTransactionReceipt, usePublicClient } from 'wagmi';
import { parseEther } from 'viem';
import { NFT_CONTRACT } from '@/lib/constants';

const MINT_PRICE = 69420;

const NFT_ABI = [
  {
    name: 'mint',
    type: 'function',
    stateMutability: 'payable',
    inputs: [{ name: 'quantity', type: 'uint256' }],
    outputs: [],
  },
] as const;

export function useMint() {
  const { address, isConnected } = useAccount();
  const publicClient = usePublicClient();
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [status, setStatus] = useState<string>('idle');

  const { writeContract, data: hash, isPending, error: writeError, reset } = useWriteContract();

  const { isLoading: isConfirming, isSuccess, isError: confirmError } = useWaitForTransactionReceipt({
    hash: hash,
    timeout: 60000, // 60 second timeout
  });

  // Track status changes
  useEffect(() => {
    if (isPending) {
      setStatus('Waiting for wallet approval...');
      console.log('â³ Waiting for wallet approval...');
    }
  }, [isPending]);

  useEffect(() => {
    if (hash) {
      setStatus(`Transaction submitted: ${hash.slice(0, 10)}...`);
      console.log('ðŸ“¤ Transaction submitted:', hash);
    }
  }, [hash]);

  useEffect(() => {
    if (isConfirming) {
      setStatus('Confirming on blockchain...');
      console.log('â›“ï¸ Confirming on blockchain...');
    }
  }, [isConfirming]);

  useEffect(() => {
    if (isSuccess) {
      setStatus('Mint successful! ðŸŽ‰');
      setIsLoading(false);
      console.log('âœ… Mint successful!');
    }
  }, [isSuccess]);

  useEffect(() => {
    if (writeError) {
      console.error('âŒ Write error:', writeError);
      setError(writeError.message || 'Transaction failed');
      setIsLoading(false);
      setStatus('idle');
    }
  }, [writeError]);

  useEffect(() => {
    if (confirmError) {
      console.error('âŒ Confirmation error');
      setError('Transaction may have failed. Check your wallet.');
      setIsLoading(false);
      setStatus('idle');
    }
  }, [confirmError]);

  const mint = useCallback(async (quantity: number = 1) => {
    if (!isConnected || !address) {
      setError('Please connect your wallet');
      return;
    }

    try {
      setIsLoading(true);
      setError(null);
      setStatus('Starting mint...');

      const totalPrice = MINT_PRICE * quantity;
      
      console.log('ðŸš€ Starting mint...');
      console.log('   Quantity:', quantity);
      console.log('   Total Price:', totalPrice, '$BASED');

      writeContract({
        address: NFT_CONTRACT as `0x${string}`,
        abi: NFT_ABI,
        functionName: 'mint',
        args: [BigInt(quantity)],
        value: parseEther(totalPrice.toString()),
        gas: BigInt(500000),
      });

    } catch (e: any) {
      console.error('âŒ Mint error:', e);
      setError(e?.message || 'Failed to mint');
      setIsLoading(false);
      setStatus('idle');
    }
  }, [isConnected, address, writeContract]);

  // Manual check transaction status
  const checkTransaction = useCallback(async () => {
    if (!hash || !publicClient) return null;
    
    try {
      const receipt = await publicClient.getTransactionReceipt({ hash });
      console.log('ðŸ“‹ Transaction receipt:', receipt);
      return receipt;
    } catch (e) {
      console.log('Transaction not yet mined or failed');
      return null;
    }
  }, [hash, publicClient]);

  const resetMint = useCallback(() => {
    setIsLoading(false);
    setError(null);
    setStatus('idle');
    reset();
  }, [reset]);

  return {
    mint,
    isLoading: isLoading || isPending || isConfirming,
    isPending,
    isConfirming,
    isSuccess,
    error,
    txHash: hash,
    status,
    checkTransaction,
    reset: resetMint,
    mintPrice: MINT_PRICE,
  };
}

ALSO UPDATE the mint button/UI to show status:

In the component using useMint:

const { mint, isLoading, status, txHash, error, isSuccess } = useMint();

// Show status to user
{isLoading && (
  <div className="text-center">
    <p className="text-cyan-400">{status}</p>
    {txHash && (
      <a 
        href={`https://explorer.bf1337.org/tx/${txHash}`}
        target="_blank"
        className="text-xs text-blue-400 underline"
      >
        View on Explorer â†’
      </a>
    )}
  </div>
)}

{error && (
  <p className="text-red-400">{error}</p>
)}

{isSuccess && (
  <p className="text-green-400">ðŸŽ‰ Mint successful!</p>
)}

ADD TIMEOUT HANDLING - If stuck for more than 60 seconds:

// In component
const [stuckTimer, setStuckTimer] = useState<NodeJS.Timeout | null>(null);

useEffect(() => {
  if (isLoading && txHash) {
    // Start a 60 second timer
    const timer = setTimeout(() => {
      console.log('âš ï¸ Transaction taking too long...');
      // Show option to check explorer
    }, 60000);
    setStuckTimer(timer);
    
    return () => {
      if (timer) clearTimeout(timer);
    };
  }
}, [isLoading, txHash]);

This will show exactly where the transaction is stuck!